
<!-- InstanceBeginEditable name="Full Width Content" -->
<div id="DataTables_Table_0_wrapper" class="dataTables_wrapper form-inline" role="grid">
  <div class="row">
  
    <div class="span6">
      <div id="DataTables_Table_0_length" class="dataTables_length">
      
      <label>
      <select size="1" name="DataTables_Table_0_length" aria-controls="DataTables_Table_0">
        <option value="10" selected="selected">10</option>
        <option value="25">25</option>
        <option value="50">50</option>
        <option value="100">100</option>
      </select> records per page
      </label>
      
      </div> <!-- id="DataTables_Table_0_length" -->
    </div> <!-- class="span6" -->
    
    <div class="span6">
      <div class="dataTables_filter" id="DataTables_Table_0_filter">
        <%= form_tag citations_path, :method => 'get', :id => 'simple_search' do %>
  			  <label>Search: <%= text_field_tag :search, params[:search] %></label>
          <%= hidden_field_tag :direction, params[:direction] %>
          <%= hidden_field_tag :sort, params[:sort] %>
        <% end %>
      </div> <!-- id="DataTables_Table_0_filter" -->
    </div> <!-- class="span6" -->
	</div> <!-- class="row" -->          
  <table class="table table-striped table-bordered table-hover datatable dataTable" id="DataTables_Table_0" aria-describedby="DataTables_Table_0_info">
		  <thead>
	      <tr role="row">
<th class="sorting_asc" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px"><%= sortable "variables.name", "Trait" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 50px"><%= sortable "species.genus", "Species" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 200px"><%= sortable "traits.mean", "Mean" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 67px"><%= sortable "traits.n", "N" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 25px"><%= sortable "traits.stat", "Stat" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px"><%= sortable "traits.statname", "Statname" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px"><%= sortable "citations.author", "Citation" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px"><%= sortable "sites.sitename", "Site" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px"><%= sortable "treatment.name", "Treatment" %></th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px">QA/QC</th>
<th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px">Access Level</th>
<th role="columnheader" aria-controls="DataTables_Table_0" style="width: 40px">Actions</th>
      </tr>
    </thead>    
	  <tbody role="alert" aria-live="polite" aria-relevant="all">
      <% @traits.each do |trait| %>
        <tr<%= " style='background-color:yellow'" if @search and !@search[/[^\d]/] and trait.id == @search.to_i%>>
          <td class="center"><%= link_to_if trait.variable, trait.variable, trait.variable %></td>
          <td class="center"><%= link_to_if trait.specie, trait.specie, trait.specie %></td>
          <td class="center"><%= trait.mean %></td>
          <td class="center"><%= trait.n %></td>
          <td class="center"><%= trait.stat %></td>
          <td class="center"><%= trait.statname %></td>
          <td class="center"><%= link_to_if trait.citation, trait.citation, trait.citation %></td>
          <td class="center"><%= link_to_if trait.site, trait.site, trait.site %></td>
          <td class="center"><%= link_to_if trait.treatment, trait.treatment, trait.treatment %></td>
          <%= raw checked_status_list(trait) %>
          <% if current_user.access_level < trait.access_level || current_user.access_level = trait.access_level and trait.checked || trait.user_id == current_user.id || current_user.page_access_level <= 2%>
          <td class="center">
           <%= select_tag "access_level-" + trait.id.to_s,options_for_select([["1.Restricted",1],['2.EBI',2],['3.External',3],['4.Public',4]],trait.access_level) %>
          </td>
          <% end%>
					<td class="center ">
					  <!-- SHOW -->
					  <%= link_to trait, :class => "button button-small", :alt => "show" do %>
					    <i class="icon-zoom-in"></i>
					  <% end %>
					  <!-- EDIT -->
					  <%= link_to edit_trait_path(trait), :class => "button button-small", :alt => "edit" do %>
					    <i class="icon-edit"></i>
					  <% end %>
					  <!-- DELETE -->
					  <% if current_user.page_access_level <= 2 or trait.user_id == current_user.id %>
              <%= link_to trait, :method => :delete, :type => 'trait', :confirm => 'Are you sure?', :class=> 'button button-small button-danger', :alt => "delete" do %>
                <i class="icon-trash"></i> 
              <% end %>
            <% end %>
				  </td>


        </tr>
      <% end %>

	  </tbody>
	</table>
  
	<div class="row">
	  <div class="span6">
	    <div class="dataTables_info" id="DataTables_Table_0_info">Showing 1 to 10 of 32 entries</div>
	  </div>
	  <div class="span6">
	    <div class="dataTables_paginate paging_bootstrap pagination alternate">
	      <ul>
	        <li class="prev disabled"><a href="#">← Previous</a></li>
	        <li class="active"><a href="#">1</a></li>
          <li><a href="#">2</a></li>
          <li><a href="#">3</a></li>
          <li><a href="#">4</a></li>
          <li class="next"><a href="#">Next → </a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

<%= will_paginate @traits %>

<br />

<% @traits.each do |trait| %>
   <%= observe_field("access_level-" + trait.id.to_s,
                  :frequency => 1,
                  :with => "'id=' + #{trait.id} + '&trait[access_level]=' + Form.Element.getValue('access_level-#{trait.id.to_s}')",
                  :url => { :action => :access_level }) %>
   <%= observe_field("checked-" + trait.id.to_s,
                  :frequency => 1,
                  :with => "'id=' + #{trait.id} + '&trait[checked]=' + Form.Element.getValue('checked-#{trait.id.to_s}')",
                  :url => { :action => :checked }) %>
<% end %>
