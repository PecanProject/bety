<div class="content">
	<div class="container">
		<div class="sixteen columns">
			<header>
				<h1>Location Yields</h1>
			</header>

      <select id="map_overlay_picker">
        <option value="cornstover_evapotranspiration_grid">cornstover evapotranspiration grid</option>
        <option value="energycane_yield_grid">energycane yield grid</option>
        <option value="miscanthus_yield_grid">miscanthus yield grid</option>
        <option value="miscanthus_evapotranspiration_grid">miscanthus evapotranspiration grid</option>
        <option value="poplar_yield_grid">poplar yield grid</option>
        <option value="switchgrass_evapotranspiration_grid">switchgrass evapotranspiration grid</option>
        <option value="switchgrass_yield_grid">switchgrass yield grid</option>
        <option value="willow_yield_grid">willow yield grid</option>
      </select>

  
      <br />
      
      <% if @fullscreen %>
      <div id="map_canvas" style="width: 100%; height: 800px"></div>
      <% else %>
      <div id="map_canvas" class="inline-table" style=" width: 700px; height: 600px"></div>
      <% end %>
      
      <div id="map_legend" class="inline-table">
        <img src="../modelout/switchgrass_evapotranspiration_grid-legend.png">
      </div>
 
      <% if @fullscreen %>
        <div style="width:100%;margin-top:5px;">
      <% else %>
        <div style="width:750px;height:100px;margin-top:5px;">
      <% end %>
      
      <% if current_user != nil %>
      
          <div style="width:200px;float:left">
            <h5>Download Model Output: </h5>
            
            <table cellpadding="0" cellspacing="0" class="moduletable">
              <tr>
                <td>
                  <script type="text/javascript">
                    var download_yield_MENU_ITEMS = [
                      ['Yield (Mg/ha)','',{'tw':'0','sb':'Yield (Mg/ha)'},
                        ['Miscanthus','',{'tw':'0','sb':'Miscanthus'},
                          ['County',      '<%= root_path %>temp_models/miscanthus_yield_county.csv'      ,{'tw':'0','sb':'County'}],
                          ['Gridded',     '<%= root_path %>temp_models/miscanthus_yield_grid.csv'        ,{'tw':'0','sb':'Gridded'}]
                        ],
                        ['Switchgrass','',{'tw':'0','sb':'Switchgrass'},
                          ['County',      '<%= root_path %>temp_models/switchgrass_yield_county.csv'     ,{'tw':'0','sb':'County'}],
                          ['Gridded',     '<%= root_path %>temp_models/switchgrass_yield_grid.csv'       ,{'tw':'0','sb':'Gridded'}]
                        ],
                        ['EnergyCane','',{'tw':'0','sb':'EnergyCane'},
                          ['County',      '<%= root_path %>temp_models/energycane_yield_county.csv'     ,{'tw':'0','sb':'County'}],
                          ['Gridded',     '<%= root_path %>temp_models/energycane_yield_grid.csv'       ,{'tw':'0','sb':'Gridded'}]
                        ],
                        ['CornStover','',{'tw':'0','sb':'CornStover'},
                          ['County',      '<%= root_path %>temp_models/cornstover_yield_county.csv'     ,{'tw':'0','sb':'County'}]
                        ],
                        ['Poplar','',{'tw':'0','sb':'Poplar'},
                          ['Gridded',     '<%= root_path %>temp_models/poplar_yield_grid.csv'          ,{'tw':'0','sb':'Gridded'}]
                        ]
                      ]
                    ];
                  </script>
                  <div style="position:relative; top:0px; left:0px; min-height:26px;">
                    <div style="position:absolute; top:0px; width: 200px; height:26px;">
                      <script type="text/javascript">
                        new menu (download_yield_MENU_ITEMS, [
                          {height:26,width:200,block_top:0,block_left:0,top:0,left:155,hide_delay:600,expd_delay:100,css:
                            {outer:["topmenu_l0oout","topmenu_l0oover"],inner:["topmenu_l0iout","topmenu_l0iover"]}
                          },
                          {height:26,width:155,block_top:26,block_left:0,top:26,left:0,css:
                            {outer:["topmenu_l1oout","topmenu_l1oover"],inner:["topmenu_l1iout","topmenu_l1iover"]}
                          },
                          {block_top:0,block_left:155}
                        ])
                      </script>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
            
            <br />
            

            <table cellpadding="0" cellspacing="0" class="moduletable">
              <tr>
                <td>


                  <script type="text/javascript">
                    var download_evapo_MENU_ITEMS = [
                      ['Evapotranspiration ','',{'tw':'0','sb':'Evapotranspiration'},
                        ['Miscanthus','',{'tw':'0','sb':'Miscanthus'},
                          ['County',      '<%= root_path %>temp_models/miscanthus_evapotranspiration_county.csv'     ,{'tw':'0','sb':'County'}],
                          ['Gridded',     '<%= root_path %>temp_models/miscanthus_evapotranspiration_grid.csv'       ,{'tw':'0','sb':'Gridded'}]
                        ],
                        ['Switchgrass','',{'tw':'0','sb':'Switchgrass'},
                          ['Gridded',     '<%= root_path %>temp_models/switchgrass_evapotranspiration_grid.csv'      ,{'tw':'0','sb':'Gridded'}]
                        ],
                        ['Cornstover','',{'tw':'0','sb':'Cornstover'},
                          ['County',      '<%= root_path %>temp_models/switchgrass_evapotranspiration_county.csv'     ,{'tw':'0','sb':'County'}],
                          ['Gridded',     '<%= root_path %>temp_models/switchgrass_evapotranspiration_grid.csv'       ,{'tw':'0','sb':'Gridded'}]
                        ]
                      ]
                    ];
                  </script>


                  <div style="position:relative; top:0px; left:0px; min-height:26px;">
                    <div style="position:absolute; top:0px; width: 200px; height:26px;">
                      <script type="text/javascript">
                        new menu (download_evapo_MENU_ITEMS, [{height:26,width:200,block_top:0,block_left:0,top:0,left:155,hide_delay:600,expd_delay:100,css:{outer:["topmenu_l0oout","topmenu_l0oover"],inner:["topmenu_l0iout","topmenu_l0iover"]}},{height:26,width:155,block_top:26,block_left:0,top:26,left:0,css:{outer:["topmenu_l1oout","topmenu_l1oover"],inner:["topmenu_l1iout","topmenu_l1iover"]}},{block_top:0,block_left:155}])
                      </script>
                    </div>
                  </div>
                </td>
              </tr>
            </table>


            
            <br /> 
          
            <table cellpadding="0" cellspacing="0" class="moduletable">
              <tr>
                <td>
                  <script type="text/javascript">
                    var download_cost_MENU_ITEMS = [
                      ['Production Cost (USD/Mt)','',{'tw':'0','sb':'Production Cost (USD/Mt)'},
                        ['Miscanthus','',{'tw':'0','sb':'Miscanthus'},
                          ['County',      '<%= root_path %>temp_models/miscanthus_cost_county.csv'      ,{'tw':'0','sb':'County'}]
                        ],
                        ['Switchgrass','',{'tw':'0','sb':'Switchgrass'},
                          ['County',      '<%= root_path %>temp_models/switchgrass_cost_county.csv'     ,{'tw':'0','sb':'County'}]
                        ],
                        ['EnergyCane','',{'tw':'0','sb':'EnergyCane'},
                          ['County',      '<%= root_path %>temp_models/energycane_cost_county.csv'     ,{'tw':'0','sb':'County'}]
                        ],
                        ['Cornstover','',{'tw':'0','sb':'Cornstover'},
                          ['County',      '<%= root_path %>temp_models/cornstover_cost_county.csv'      ,{'tw':'0','sb':'County'}]
                        ],
                        ['All','',{'tw':'0','sb':'All'},
                          ['Yield and County','<%= root_path %>temp_models/all_yield_and_cost_county.csv',{'tw':'0','sb':'YieldAndCounty'}],
                          ['Least Cost','<%= root_path %>temp_models/least_cost_crop_county.csv'       ,{'tw':'0','sb':'Least'}]
                        ]
                      ]
                    ];
                  </script>
                  <div style="position:relative; top:0px; left:0px; min-height:26px;">
                    <div style="position:absolute; top:0px; width: 200px; height:26px;">
                      <script type="text/javascript">
                        new menu (download_cost_MENU_ITEMS, [{height:26,width:200,block_top:0,block_left:0,top:0,left:155,hide_delay:600,expd_delay:100,css:{outer:["topmenu_l0oout","topmenu_l0oover"],inner:["topmenu_l0iout","topmenu_l0iover"]}},{height:26,width:155,block_top:26,block_left:0,top:26,left:0,css:{outer:["topmenu_l1oout","topmenu_l1oover"],inner:["topmenu_l1iout","topmenu_l1iover"]}},{block_top:0,block_left:155}])
                      </script>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
            
          </div>
          
      <% end %>

          <div style="width:200px;float:right">
            <table cellpadding="0" cellspacing="0" class="moduletable">
              <tr>
                <td>
                  <script type="text/javascript">
//var download_MENU_ITEMS = [
//  <% if @fullscreen %>
//  ['Exit fullscreen','/maps/location_yields',{'tw':'0','sb':'Exit fullscreen'}]
//  <% else %>
//  ['Fullscreen','/maps/location_yields?fullscreen=true',{'tw':'0','sb':'Fullscreen'}]
//  <% end %>
//];
                  </script>
                  <div style="position:relative; top:0px; left:0px; min-height:26px;">
                    <div style="position:absolute; top:0px; width: 200px; height:26px;">
                      <script type="text/javascript">
//                        new menu (download_MENU_ITEMS, [{height:26,width:200,block_top:0,block_left:0,top:0,left:155,hide_delay:600,expd_delay:100,css:{outer:["topmenu_l0oout","topmenu_l0oover"],inner:["topmenu_l0iout","topmenu_l0iover"]}},{height:26,width:155,block_top:26,block_left:0,top:26,left:0,css:{outer:["topmenu_l1oout","topmenu_l1oover"],inner:["topmenu_l1iout","topmenu_l1iover"]}},{block_top:0,block_left:155}])
                      </script>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>


      <br /><br /><br />
      
      
      
    <script type="text/javascript">
    // Place your application-specific JavaScript functions and classes here
// This file is automatically included by javascript_include_tag :defaults




function initalize_google_map( overlay_type ) {
  var minZoomLevel = 2;
  var geocoder;
  var address;
  var latlng = new google.maps.LatLng(37.09024, -95.712891);
  var myOptions = {
    zoom: minZoomLevel,
    streetViewControl: false,
    mapTypeControl: false,
    panControl: false,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var overlayOptions = {
    opacity: 0.6,
  }

  // Google coordinate plane increases in the positive number direction left to right
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

  var standard_us_bz_bounds = new google.maps.LatLngBounds(
    new google.maps.LatLng(-45,-135), // south-west
    new google.maps.LatLng(65,-25) // north-east

  );

  var cornstover_evapotranspiration_grid = new google.maps.GroundOverlay( '../modelout/cornstover_evapotranspiration_grid.png', standard_us_bz_bounds, overlayOptions );

  var energycane_yield_grid = new google.maps.GroundOverlay( '../modelout/energycane_yield_grid.png', standard_us_bz_bounds, overlayOptions );

  var miscanthus_evapotranspiration_grid = new google.maps.GroundOverlay( '../modelout/miscanthus_evapotranspiration_grid.png', standard_us_bz_bounds, overlayOptions );

  var miscanthus_yield_grid = new google.maps.GroundOverlay( '../modelout/miscanthus_yield_grid.png', standard_us_bz_bounds, overlayOptions );
  
  var poplar_yield_grid = new google.maps.GroundOverlay( '../modelout/poplar_yield_grid.png', standard_us_bz_bounds, overlayOptions );

  var switchgrass_evapotranspiration_grid = new google.maps.GroundOverlay( '../modelout/switchgrass_evapotranspiration_grid.png', standard_us_bz_bounds, overlayOptions );
  
  var switchgrass_yield_grid = new google.maps.GroundOverlay( '../modelout/switchgrass_yield_grid.png', standard_us_bz_bounds, overlayOptions );
  
  var willow_yield_grid = new google.maps.GroundOverlay( '../modelout/willow_yield_grid.png', standard_us_bz_bounds, overlayOptions );
  

  eval(overlay_type).setMap(map);

  image_url = '../modelout/' + overlay_type + '-legend.png'
  console.log( image_url );
  jQuery("#map_legend").find('img').attr('src', image_url )

  //pulls the #map_legend into the google maps canvas
  //map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push( document.getElementById('map_legend') );

  
  // Bounds for A single map
   var strictBounds = new google.maps.LatLngBounds(
     new google.maps.LatLng(-70, -170), // bottom-left
     new google.maps.LatLng(70, 170)   // top-right
   );

   // Listen for the map click events
   google.maps.event.addListener(map, 'dragend', function() {
     if (strictBounds.contains(map.getCenter())) return;

     // We're out of bounds - Move the map back within the bounds
     var c = map.getCenter(),
         x = c.lng(),
         y = c.lat(),
         maxX = strictBounds.getNorthEast().lng(),
         maxY = strictBounds.getNorthEast().lat(),
         minX = strictBounds.getSouthWest().lng(),
         minY = strictBounds.getSouthWest().lat();

     if (x < minX) x = minX;
     if (x > maxX) x = maxX;
     if (y < minY) y = minY;
     if (y > maxY) y = maxY;

     map.setCenter(new google.maps.LatLng(y, x));
   });

  // Limit the zoom level
  google.maps.event.addListener(map, 'zoom_changed', function() {
    if (map.getZoom() < minZoomLevel) map.setZoom(minZoomLevel);
  });
  
  markersArray = [];
}


jQuery("#map_overlay_picker").change( function(){
  initalize_google_map( jQuery("#map_overlay_picker").val() )
});

initalize_google_map( "miscanthus_yield_grid" )
    
    </script>


		</div> <!-- class="sixteen columns" -->
	</div> <!-- container --> 
</div>
